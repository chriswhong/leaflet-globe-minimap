!function(t,o){if("object"==typeof exports&&"object"==typeof module)module.exports=o(require("d3"),require("leaflet"),require("topojson-client"));else if("function"==typeof define&&define.amd)define(["d3","leaflet","topojson-client"],o);else{var n="object"==typeof exports?o(require("d3"),require("leaflet"),require("topojson-client")):o(t.d3,t.L,t.topojson);for(var e in n)("object"==typeof exports?exports:t)[e]=n[e]}}(this,function(t,o,n){return function(t){function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var n={};return o.m=t,o.c=n,o.i=function(t){return t},o.d=function(t,n,e){o.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:e})},o.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(n,"a",n),n},o.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},o.p="",o(o.s=3)}([function(o,n){o.exports=t},function(t,n){t.exports=o},function(t,o){t.exports=n},function(t,o,n){"use strict";n(0);var e=n(1),i=function(t){return t&&t.__esModule?t:{default:t}}(e);n(2),i.default.Control.GlobeMiniMap=i.default.Control.extend({options:{position:"bottomright",width:82,height:82,land:"#bbb",water:"rgba(0, 0, 0, 0.3)",marker:"#CC0000",topojsonSrc:"data/world.json"},initialize:function(t){i.default.Util.setOptions(this,t),console.log(this.options)},onAdd:function(t){return console.log("onAdd()"),this._mainMap=t,this._container=i.default.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",i.default.DomEvent.disableClickPropagation(this._container),i.default.DomEvent.on(this._container,"mousewheel",i.default.DomEvent.stopPropagation),this._userToggledDisplay=!1,this._minimized=!1,this._mainMap.on("moveend",this._onMainMapMoved,this),this._container},addTo:function(t){return console.log("addTo()"),i.default.Control.prototype.addTo.call(this,t),this.initCanvas(),this},initCanvas:function(){d3.select(".leaflet-control-minimap").append("svg").attr("width",82).attr("height",82).attr("style","position: absolute; left: 0; top: 0;").append("path").attr("d","m 768,896 q 0,106 -75,181 -75,75 -181,75 -106,0 -181,-75 -75,-75 -75,-181 0,-106 75,-181 75,-75 181,-75 106,0 181,75 75,75 75,181 z m 256,0 q 0,-109 -33,-179 L 627,-57 q -16,-33 -47.5,-52 -31.5,-19 -67.5,-19 -36,0 -67.5,19 Q 413,-90 398,-57 L 33,717 Q 0,787 0,896 q 0,212 150,362 150,150 362,150 212,0 362,-150 150,-150 150,-362 z").attr("transform","scale(.01,-.01),translate(3600,-3900)").attr("style","fill:"+this.options.marker),this.projection=d3.geo.orthographic().scale(40).translate([41,41]).rotate([0,0]).clipAngle(90);var t=d3.select(".leaflet-control-minimap").append("canvas").attr("width",400).attr("height",400);this.c=t.node().getContext("2d"),this.path=d3.geo.path().projection(this.projection).context(this.c);var o=this;d3.json(this.options.topojsonSrc,function(t){o.globe={type:"Sphere"},o.land=topojson.feature(t,t.objects.land)}),this.transitionMap(this._mainMap.getCenter())},transitionMap:function(t){console.log("transtionMap");var o=this,n=o.c,e=o.path;d3.transition().duration(1250).each("start",function(){}).tween("rotate",function(){var i=d3.interpolate(o.projection.rotate(),[-t.lng,-t.lat]);return function(t){o.projection.rotate(i(t)),n.clearRect(0,0,o.options.width,o.options.height),n.fillStyle=o.options.water,n.beginPath(),e(o.globe),n.fill(),n.fillStyle=o.options.land,n.beginPath(),e(o.land),n.fill()}})},onRemove:function(t){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this)},_onMainMapMoved:function(t){console.log("mainmapmoved"),this._miniMapMoving?this._miniMapMoving=!1:(this._mainMapMoving=!0,this.transitionMap(this._mainMap.getCenter()))}}),i.default.control.globeminimap=function(t,o){return new i.default.Control.GlobeMiniMap(t,o)},i.default.Map.mergeOptions({miniMapControl:!1}),i.default.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new GlobeMiniMap).addTo(this))})}])});